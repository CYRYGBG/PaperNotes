## Physics-Informed_Attention_Temporal_Convolutional_Network_for_EEG-Based_Motor_Imagery_Classification

### 简介

论文提出了一种基于注意力机制的时间卷积网络用于运动想象分类任务，其中注意力机制用于提取EEG数据中最具价值的特征，时间卷积网络用语提取高层次的时间特征，另外，基于滑动窗口的卷积可以增强EEG数据的使用有效性，在 BCI Competition IV-2a数据集中被试依赖和被试独立都获得了SOTA结果。

论文提出他们的贡献有以下几点：

- 提出了高性能的ATCNet
- 通过并行化方法减少了卷积的计算和增加了EEG的数据量
- 自注意力机制帮助模型关注EEG数据中最有效的MI信息
- 在 BCI Competition IV-2a数据集上获得了杰出的效果

### 模型

模型分为三个部分：卷积块(CV)、注意力块(AT)和时间卷积块(TC)。其中，卷积块用于提取低层次的时空特征，注意力块用于突出前一部分的输出所构成的时间序列特征中最重要的信息，最后的时间卷积块则用于提取高层次的时间特征。

![image-20250326103220272](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326103220301.png)

关于模型的输入，论文直接将原始的EEG信号输入模型，不进行预处理（全频段、所有通道、不去除伪影）。

![image-20250326103320514](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326103320570.png)

在卷积模块中，总共有三次卷积：**第一次卷积**在每个通道上的时间维度进行，用于提取每个通道中的时间特征，卷积核大小为(1, KC)，KC设置为采样率的四分之一（64）；**第二次卷积**在空间维度上进行，用于提取每个时间点下不同通道之间的相关性特征，卷积核大小为(C, 1)，其中C是EEG数据的通道数（22）；**第三次卷积**使用大小为 (1, KC2) 的卷积核，其中 KC2 设置为 16，用于提取500ms内的MI活动。另外，第二次卷积和第三次卷积后均使用BatchNorm和平均池化层对特征完成进一步提取，在后续的实验中，这部分的池化核大小分别为(1, 8)和(1, 7)。

在输入注意力块前，模型使用滑动窗口将前一步获取的特征划分为不同的时间序列，每个窗口单独传入后续的注意力块和时间卷积块中，论文认为这种方法可以有效增强数据，使模型可以学些从不同时间点提取的运动想象信息来提高分类精度，同时由于是并行运算的，可以加快模型的训练和推理过程。

![image-20250326105859042](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326105859071.png)

在注意力块部分中，模型使用多头注意力机制重新为不同时间点下的特征分配注意力权重，使模型对特征的选择产生偏向性。

![image-20250326110748782](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326110748828.png)

在时间卷积块中，模型使用了两层由残差连接的TCN网络。从数据的时间特性上，TCN可以使模型只关注当前时间点及之前的信息，防止未来的信息泄露到现在（也叫因果卷积）。另外，在第二个TCN层中使用了扩展卷积，可以扩大卷积的感受野，这部分的设计可以提取长时间跨度内的信息。

时间卷积块在所有时间窗口的输出经过拼接后输入全连接层得到最后的分类结果输出。

### 数据集

BCI Competition IV-2a数据集中共有9名被试，每名被试采集576个样本，分两次采集完成，共5184个样本。样本分为四类运动想象：左手、右手、双脚和舌头。

论文分别进行了被试依赖和被试独立实验。在被试依赖实验中，一次采集的数据用于训练，另一次的数据用于测试；在被试独立实验中，使用被试留一交叉实验。

### 实验结果及对比

在被试依赖实验中，ATCNet取得了最好的效果，其中k-score用于衡量分类任务中分类结果的一致性程度，可以避免因类别不平衡导致的高准确率假象。

![image-20250326114304859](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326114304886.png)

同样的，在被试独立实验中，ATCNet也取得了最好的效果。

![image-20250326114544653](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326114544681.png)

论文选取了几个结构相近的模型进行复现，并根据分类结果绘制出了混淆矩阵图，可以看出，ATCNet的准确率显著提高，尤其在减少任务间混淆方面表现突出。

![image-20250326194737057](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326194737173.png)



### 消融实验

![image-20250326190436454](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326190436555.png)

其中AT表示注意力块，SW表示前面提到的滑动窗口分割序列的方法，TC表示时间卷积网络。该表格表示移除对应模块后的模型分类指标。可以看到，移除AT，也就是**移除注意力块**后，准确率和kappa指标都有所下降，论文认为这表明了注意力块对整体性能有正向提升，增强了模型聚焦于EEG中最相关信息的能力；对应的移除SW，也就是**移除滑动窗口部分**的处理后，也是两个指标都发生了下降。值得关注的是，如果**去掉了最后的时间卷积块**，模型的准确率下降的最多，论文认为这表明在移除TC部分后，直接通过注意力块获取输出而不另接其他模块对模型是有害的。

### 参数敏感度分析

![image-20250326191843302](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326191843488.png)

论文研究了卷积块部分提取的时间特征长度以及注意力块中的时间窗口数量对模型准确率的影响。总的来说，论文认为提高滑动窗口划分结果的数量可以提高模型的分类准确率，但是当这个滑动窗口过小时，由于这个区间内没有包含足够的信息，这时就会导致准确率发生下降。

另外，当卷积块输出的时间特征长度小于时间卷积块的感受野时，模型的性能最佳；当卷积块输出的时间特征长度大于时间卷积块的感受野范围时，由于存在信息丢失，模型准确率会下降。

![image-20250326193708963](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326193709118.png)

论文接下来对比了不同的注意力头数和每个注意力头中间层维度对模型准确率的影响，可以看到使用两个注意力头和维度为8时效果最好，论文认为这是因为数据量有限以及数据本身蕴含的信息也有限。

另外，论文也对比了不同类型的注意力机制，发现还是多头自注意力机制的效果是最好的。

![image-20250326194211853](https://gitee.com/fbanhua/figurebed/raw/master/images/20250326194211938.png)

### 总结

论文提出的模型主要由以下几个块构成：

- **CV Block**：通过三层卷积（时间→空间→时间）编码原始EEG信号的时空信息
- **AT Block**：利用多头自注意力机制动态聚焦关键特征，减少噪声干扰
- **TC Block**：通过时间卷积提取长时序依赖，增强模型对复杂时序模式的建模能力

论文认为后续的工作可以开发一种能有效提取EEG数据中特定时间区间、通道位置和频段中信息的模型。